(function(C,y){typeof exports=="object"&&typeof module!="undefined"?module.exports=y():typeof define=="function"&&define.amd?define(y):(C=typeof globalThis!="undefined"?globalThis:C||self,C.Layouter=y())})(this,function(){"use strict";const C=(e,t)=>{const n={};return t==="width"?Object.keys(e).map(s=>({alias:s,width:e[s].width})).sort((s,r)=>s.width>r.width?1:r.width>s.width?-1:0).forEach((s,r)=>{n[s.alias]=r?e[s.alias][t]:0}):Object.keys(e).forEach(s=>{n[s]=e[s][t]}),n},y=({bridge:e,bp:t,insertionType:n,node:s,context:r})=>{let o=r.document.getElementById("layouter-"+t);if(!o){o=r.document.createElement("style"),o.appendChild(r.document.createTextNode(""));const i=s.parentNode;switch(n){case"before":i.insertBefore(o,s);break;case"after":s.nextSibling?i.insertBefore(o,s.nextSibling):i.appendChild(o);break;case"append":s.appendChild(o);break}o.id="layouter-"+t}let l;return e?l={method:o.sheet,node:o}:l={method:{insertRule:i=>{o.appendChild(r.document.createTextNode(i))},rules:[]},node:o},l},de=({breakpoints:e,bridge:t,scope:n,context:s})=>{const r=n||{};return Object.keys(e).forEach(o=>{r[o]||(r[o]=y({bridge:t,bp:o,insertionType:"append",node:s.document.body,context:s}))}),r},fe=(e,t)=>{const n={};return Object.keys(t).forEach(s=>n[s]=e[s]),n},pe="1.3.1";let k={prefix:"",breakpoints:{xs:{width:360,cols:15},sm:{width:600,cols:25},md:{width:900,cols:31},lg:{width:1200,cols:41},xlg:{width:1536,cols:51}},bridge:!0,debug:!0},b;const B=({bps:e,bridge:t,scope:n,context:s})=>{const r=C(e,"width"),o=fe(e,r);return{sizes:r,cols:C(e,"cols"),scope:de({breakpoints:o,bridge:t,scope:n,context:s}),breakpoints:o}},be=(e,t={})=>{const n=e.layouterConfig||{};return k={...k,...t,...n},b={context:e,...k,...B({bps:k.breakpoints,bridge:k.bridge,context:e}),styles:{},version:pe},b},h=()=>b,me=(e,t)=>{b.styles[e]=t},he=e=>(b={...b,...e},e.breakpoints&&(b={...b,...B({bps:b.breakpoints,bridge:b.bridge,scope:b.scope,context:b.context})}),b),O=e=>{let t,n=e,s=!1;const r=n.includes("@");if(r){const o=n.split("@");n=o[0],t=o[1]}else{const o=h();t=Object.keys(o.breakpoints)[0]}return e.includes("!")&&(s=!0,t=t.replace(/!/g,""),n=n.replace(/!/g,"")),{widthBp:r,numbers:n,breakPoints:t,important:s}},x=(e,t,n)=>{const s=new Error;return s.name=e,s.message=t,h().debug&&(console.error(s),n&&console.log(n)),s},L=(e,t)=>{const n=e*100/t;return(n-Math.floor(n)!==0?n.toFixed(3):n)+"%"},ge=e=>{const t=e.replace(/!/g,""),n=t.indexOf("@"),s=h(),r=s.scope,o=s.bridge,l=s.context;if(n===-1){const c=Object.keys(s.breakpoints)[0];return r[c]}const i=t.substring(n+1);if(!i.includes("-"))return r[i];if(i.substring(0,1)==="-"){if(r[i])return r[i];const c=i.substring(1);return r[i]=y({bridge:o,bp:i,insertionType:"before",node:r[c].node,context:l}),r[i]}if(r[i])return r[i];const a=i.split("-")[0];return r[i]=y({bridge:o,bp:i,insertionType:"after",node:r[a].node,context:l}),r[i]},F=e=>{const t=h();for(const n in e)if(!t.styles[n]){const s=ge(n),r=e[n],o=s.method.rules;s.method.insertRule(r,o?o.length:0),me(n,r)}},v={jc:"justify-content",ai:"align-items",ce:"center",fs:"flex-start",fe:"flex-end",sb:"space-between",sa:"space-around",fw:"flex-wrap",nw:"nowrap",w:"wrap",wr:"wrap-reverse",fd:"flex-direction",r:"row",rr:"row-reverse",co:"column",cor:"column-reverse",fg:"flex-grow",fh:"flex-shrink",as:"align-self",or:"order",au:"auto",st:"stretch",bl:"baseline",in:"initial",ih:"inherit"},D=["fg","fh","or"],xe=e=>"0\xAF"+e.replace("%",""),ye=(e,t)=>{const n=h(),s=n.sizes,r=n.prefix,o=P[e].ruleCss,l={};return Object.keys(t).forEach(i=>{const a=t[i].name;let c=a;a.includes("%")&&(c=a.replace(a,xe(a))),c=(r?r+"-":"")+e+"-"+c.replace(/\//g,"\\/").replace(/:/g,"\\:").replace("@","\\@").split(".").join("_");let m;if(e==="flex"){m=t[i].value;const w=a.includes("!")?";display:flex !important;":";display:flex;",j=["as"].concat(D).filter(T=>a.includes(T+":"));j.length?j.length+1!==a.split(":").length&&(m+=w):m+=w}else m=o+":"+t[i].value;let u="@media screen and ",g=!1;if(!i.includes("-"))s[i]?u+="(min-width: "+s[i]+"px)":(u="."+c.replace(/!/g,"\\!")+"{"+m+"}",g=!0);else{const w=i.split("-"),j=w[0];j&&(u+="(min-width: "+s[j]+"px) and ");const T=w[1];u+="(max-width: "+(s[T]-1)+"px)"}g||(u+="{."+c.replace(/!/g,"\\!")+"{"+m+"}}"),l[c]=u}),l},we=[["/",""],["\\","/"],["/:",":"],["\\:",":"],["\\@","@"],["/@","@"]],Ce=e=>{const t={};for(const n in e){let s=n;we.forEach(r=>{s=s.split(r[0]).join(r[1])}),t[s]=e[n]}return t},A=e=>{const t=ye(e.type,e.bps);return e.deep&&F(t),Ce(t)},M=(e,t=!1)=>{let n,s;const r={},o=h();let l,i,a;const c=Object.keys(o.breakpoints)[0];let p=!1;for(const m of e.split(" ")){let u=m;if(l=u,a=O(u),s=a.breakPoints,u=a.numbers,u.includes("/")){const g=u.split("/");n=[Number(g[0]),Number(g[1])]}else if(a.widthBp)if(s.includes("-")){p=x("SyntaxError","You can't determine a 'until breakpoint' when use the explicit columns max: "+e);break}else n=[Number(u),o.cols[s]];else n=[Number(u),o.cols[c]];i=L(n[0],n[1]),a.important&&(i+=" !important"),r[s]={name:l,value:i}}return p||A({type:"cols",bps:r,deep:t})},S=(e,t=!1)=>{const n={};let s=!1;const r=h(),o=Object.keys(r.breakpoints)[0];for(const l of e.split(" ")){let i,a=l;const c=O(l),p=c.breakPoints,m=c.numbers.split(":"),u=m[0],g=m[1];if(D.includes(u))i=v[u]+":"+g;else{if(!v[u]){s=x("Non-existent Alias","Don't exists the alias '"+u+"' in Flex vault.");break}if(!v[g]){s=x("Non-existent Alias","Don't exists the alias '"+g+"' in Flex vault.");break}i=v[u]+":"+v[g]}if(c.important&&(i+=" !important"),!n[p])n[p]={name:a,value:i};else{a.includes("@")&&(a=a.split("@")[0]);const w=p===o?"":"@"+p;n[p].name=n[p].name.split("@")[0]+"-"+a+w,n[p].value+=";"+i}}return s||A({type:"flex",bps:n,deep:t})},Pe=["%","rem","em","ex","vw","vh","pt","cm","pc"],ke=e=>{let t;return e.includes("/")?(t=e.split("/"),t=L(parseFloat(t[0]),parseFloat(t[1]))):e==="auto"?t="auto":Pe.filter(s=>e.includes(s)).length?t=e:t=e==="0"?e:e+"px",t},d=(e,t,n=!1)=>{const s={};return e.split(" ").forEach(r=>{const o=O(r),l=o.breakPoints;let i=o.numbers.split("-").map(a=>ke(a)).join(" ");o.important&&(i+=" !important"),s[l]={name:r,value:i}}),A({type:t,bps:s,deep:n})},R=(e,t=!1)=>d(e,"pad",t),N=(e,t=!1)=>d(e,"padt",t),H=(e,t=!1)=>d(e,"padr",t),V=(e,t=!1)=>d(e,"padb",t),W=(e,t=!1)=>d(e,"padl",t),I=(e,t=!1)=>d(e,"mar",t),z=(e,t=!1)=>d(e,"mart",t),U=(e,t=!1)=>d(e,"marr",t),q=(e,t=!1)=>d(e,"marb",t),Y=(e,t=!1)=>d(e,"marl",t),_=(e,t=!1)=>d(e,"mxw",t),$=(e,t=!1)=>d(e,"mxh",t),G=(e,t=!1)=>d(e,"miw",t),J=(e,t=!1)=>d(e,"mih",t),K=(e,t=!1)=>d(e,"hgt",t),Q=(e,t=!1)=>d(e,"wdh",t),X={st:"static",ab:"absolute",fi:"fixed",re:"relative",si:"sticky",in:"initial",ih:"inherit"},Z=(e,t=!1)=>{const n={};let s=!1;for(const r of e.split(" ")){let o;const l=r,i=O(r),a=i.breakPoints,c=i.numbers;if(!X[c]){s=x("Non-existent Alias","Don't exists the alias '"+c+"' in Position vault.");break}o=X[c],i.important&&(o+=" !important"),n[a]={name:l,value:o}}return s||A({type:"pos",bps:n,deep:t})},ee=(e,t=!1)=>d(e,"t",t),te=(e,t=!1)=>d(e,"r",t),se=(e,t=!1)=>d(e,"b",t),re=(e,t=!1)=>d(e,"l",t),P={cols:{build:M,ruleCss:"width"},pad:{build:R,ruleCss:"padding"},padt:{build:N,ruleCss:"padding-top"},padr:{build:H,ruleCss:"padding-right"},padb:{build:V,ruleCss:"padding-bottom"},padl:{build:W,ruleCss:"padding-left"},mar:{build:I,ruleCss:"margin"},mart:{build:z,ruleCss:"margin-top"},marr:{build:U,ruleCss:"margin-right"},marb:{build:q,ruleCss:"margin-bottom"},marl:{build:Y,ruleCss:"margin-left"},flex:{build:S,ruleCss:"display: flex"},mxw:{build:_,ruleCss:"max-width"},mxh:{build:$,ruleCss:"max-height"},miw:{build:G,ruleCss:"min-width"},mih:{build:J,ruleCss:"min-height"},wdh:{build:Q,ruleCss:"width"},hgt:{build:K,ruleCss:"height"},pos:{build:Z,ruleCss:"position"},t:{build:ee,ruleCss:"top"},r:{build:te,ruleCss:"right"},b:{build:se,ruleCss:"bottom"},l:{build:re,ruleCss:"left"}},ne=e=>{const t={},n=e.attributes,s=Object.keys(P);return Array.prototype.forEach.call(n,r=>{s.includes(r.name)&&r.value!==""&&(t[r.name]=r.value.trim().split(" ").filter(o=>o).join(" "))}),t},oe=(e,t=!1)=>{const n={};let s=!1;for(const r in e){const l=P[r].build(e[r],t);if(l instanceof Error){s=l;break}else n[r]=l}return s||n},ie=(e,t,n)=>new Promise(s=>{const r=h(),o=t.split(" ");let l=o;if(!n&&(l=o.filter(a=>!e.classList.contains(a)),!l.length)){s();return}const i=new r.context.MutationObserver(a=>{const p=a[0].target.className.split(" ");o.every(u=>p.includes(u))&&(i.disconnect(),s())});if(i.observe(e,{childList:!1,subtree:!1,attributes:!0,attributeFilter:["class"],characterData:!1}),n)e.className=t;else{const a=e.hasAttribute("class")?" ":"";e.className+=a+l.join(" ")}}),le=(e,t,n)=>new Promise(s=>{if(!e.hasAttribute(t)){s();return}const r=new n.MutationObserver(()=>{r.disconnect(),s()});r.observe(e,{childList:!1,subtree:!1,attributes:!0,attributeFilter:[t],characterData:!1}),e.removeAttribute(t)}),ve=(e,t,n)=>new Promise(s=>{const r=t.map(o=>le(e,o,n));Promise.all(r).then(()=>s())}),ae=(e,t)=>new Promise(n=>{const s=h();Array.isArray(t)?ve(e,t,s.context).then(n):le(e,t,s.context).then(n)}),E=({node:e,directive:t,classes:n,resolve:s})=>{const r=h();ae(e,t).then(()=>ie(e,n)).then(()=>{s();const o=new r.context.CustomEvent("layout:ready");e.dispatchEvent(o)})},je=(e,t)=>new Promise((n,s)=>{const r=t||ne(e),o=Object.keys(r);if(!o.length){const p=x("Parameter Missing","don't exists any parameter to process",e);s(p);return}const l={};for(const p in r)l[p]=r[p];const i=oe(l,!0);if(i instanceof Error){s(i);return}const a=i,c=Object.keys(a).map(p=>Object.keys(a[p])).flat().join(" ");E({node:e,directive:o,classes:c,resolve:n})}),Oe=(e,t)=>new Promise((n,s)=>{const r=t||e.getAttribute("flex");if(!r){const i=x("Empty",'The value of the directive "flex" is empty',e);s(i);return}const o=S(r,!0);if(o instanceof Error){s(o);return}const l=Object.keys(o).join(" ");E({node:e,directive:"flex",classes:l,resolve:n})}),Ae=(e,t)=>new Promise((n,s)=>{const r=t||e.getAttribute("cols");if(!r){const i=x("Empty","The value of the directive 'cols' is empty",e);s(i);return}const o=M(r,!0);if(o instanceof Error){s(o);return}const l=Object.keys(o).join(" ");E({node:e,directive:"cols",classes:l,resolve:n})}),f=(e,t,n)=>new Promise((s,r)=>{const o=n||e.getAttribute(t);if(!o){const a=x("Empty",'The value of the directive "'+t+'" is empty',e);r(a);return}const l=d(o,t,!0),i=Object.keys(l).join(" ");E({node:e,directive:t,classes:i,resolve:s})}),Ee=(e,t)=>f(e,"hgt",t),Me=(e,t)=>f(e,"marb",t),Se=(e,t)=>f(e,"marl",t),Te=(e,t)=>f(e,"marr",t),Be=(e,t)=>f(e,"mar",t),Le=(e,t)=>f(e,"mart",t),Fe=(e,t)=>f(e,"mxw",t),De=(e,t)=>f(e,"mih",t),Re=(e,t)=>f(e,"miw",t),Ne=(e,t)=>f(e,"padb",t),He=(e,t)=>f(e,"padl",t),Ve=(e,t)=>f(e,"padr",t),We=(e,t)=>f(e,"pad",t),Ie=(e,t)=>f(e,"padt",t),ze=(e,t)=>f(e,"wdh",t),Ue=(e,t)=>f(e,"mxh",t),qe=(e,t)=>f(e,"pos",t),Ye=(e,t)=>f(e,"t",t),_e=(e,t)=>f(e,"r",t),$e=(e,t)=>f(e,"b",t),Ge=(e,t)=>f(e,"l",t),Je=e=>new Promise(t=>{const n=Object.keys(P),s=[];if(e.className.split(" ").filter(r=>{if(r.length<4)return s.push(r),!1;const o=r.length>=5?5:4;let l=r.substring(0,o);const i=l.split("").indexOf("-");return i===-1?(s.push(r),!1):(l=l.substring(0,i),n.includes(l)?!0:(s.push(r),!1))}),s.length){const r=s.join(" ");ie(e,r,!0).then(()=>{t()})}else ae(e,"class").then(()=>{t()})}),ce=(e,t)=>new Promise(n=>{const r=Object.keys(P).map(a=>`[${a}]`).join(", "),o=t.querySelectorAll(r);if(!o.length){n(e);return}const l=new Set;Array.prototype.forEach.call(o,a=>{l.add(a)});const i=[];l.forEach(a=>{i.push(e.set(a))}),Promise.all(i).then(n)}),Ke=e=>{const t=h(),n=Object.keys(P),s=new e.context.MutationObserver(o=>{for(const l of o)if(l.type==="childList"){if(!l.addedNodes.length)continue;l.addedNodes.forEach(i=>{if(i instanceof HTMLElement){const a=e.getParameters(i);Object.keys(a).length&&e.set(i,a),ce(e,i)}})}else if(l.type==="attributes"){const i=l.target;if(i instanceof HTMLElement){const a=e.getParameters(i);Object.keys(a).length&&e.set(i,a)}}}),r={childList:!0,subtree:!0,attributes:!0,attributeFilter:n,characterData:!1};s.observe(t.context.document.body,r)},ue=(e,t={})=>{const s={...be(e,t),getParameters:ne,updateConfig:he,insertRules:F,build:oe,buildCols:M,buildFlex:S,buildPad:R,buildPadTop:N,buildPadRight:H,buildPadBottom:V,buildPadLeft:W,buildMar:I,buildMarTop:z,buildMarRight:U,buildMarBottom:q,buildMarLeft:Y,buildMaxWidth:_,buildMaxHeight:$,buildMinWidth:G,buildMinHeight:J,buildHeight:K,buildWidth:Q,set:je,setCols:Ae,setFlex:Oe,setMar:Be,setMarTop:Le,setMarRight:Te,setMarBottom:Me,setMarLeft:Se,setPad:We,setPadTop:Ie,setPadRight:Ve,setPadBottom:Ne,setPadLeft:He,setWidth:ze,setMinWidth:Re,setMaxWidth:Fe,setHeight:Ee,setMinHeight:De,setMaxHeight:Ue,reset:Je,buildPosition:Z,buildTop:ee,buildRight:te,buildBottom:se,buildLeft:re,setPosition:qe,setTop:Ye,setRight:_e,setBottom:$e,setLeft:Ge};return ce(s,e.document).then(()=>{s.ready&&s.ready(s),Ke(s)}),s};return typeof window!="undefined"&&typeof exports=="undefined"&&(window.layouter=ue(window)),ue});
//# sourceMappingURL=layouter.umd.js.map

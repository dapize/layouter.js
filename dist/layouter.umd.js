(function(E,A){typeof exports=="object"&&typeof module!="undefined"?module.exports=A():typeof define=="function"&&define.amd?define(A):(E=typeof globalThis!="undefined"?globalThis:E||self,E.Layouter=A())})(this,function(){"use strict";const E=(e,s)=>{const r={};return s==="width"?Object.keys(e).map(t=>({alias:t,width:e[t].width})).sort((t,n)=>t.width>n.width?1:n.width>t.width?-1:0).forEach((t,n)=>{r[t.alias]=n?e[t.alias][s]:0}):Object.keys(e).forEach(t=>{r[t]=e[t][s]}),r},A=({bridge:e,bp:s,insertionType:r,node:t,context:n})=>{let i=n.document.getElementById("layouter-"+s);if(!i){i=n.document.createElement("style"),i.appendChild(n.document.createTextNode(""));const l=t.parentNode;switch(r){case"before":l.insertBefore(i,t);break;case"after":t.nextSibling?l.insertBefore(i,t.nextSibling):l.appendChild(i);break;case"append":t.appendChild(i);break}i.id="layouter-"+s}let o;return e?o={method:i.sheet,node:i}:o={method:{insertRule:l=>{i.appendChild(n.document.createTextNode(l))},rules:[]},node:i},o},ge=({breakpoints:e,bridge:s,scope:r,context:t})=>{const n=r||{};return Object.keys(e).forEach(i=>{n[i]||(n[i]=A({bridge:s,bp:i,insertionType:"append",node:t.document.body,context:t}))}),n},Pe=(e,s)=>{const r={};return Object.keys(s).forEach(t=>r[t]=e[t]),r},Ce="1.5.0";let M={prefix:"",breakpoints:{xs:{width:360,cols:15},sm:{width:600,cols:25},md:{width:900,cols:31},lg:{width:1200,cols:41},xlg:{width:1536,cols:51}},bridge:!0,debug:!0},x;const H=({bps:e,bridge:s,scope:r,context:t})=>{const n=E(e,"width"),i=Pe(e,n);return{sizes:n,cols:E(e,"cols"),scope:ge({breakpoints:i,bridge:s,scope:r,context:t}),breakpoints:i}},we=(e,s={})=>{const r=e.layouterConfig||{};return M={...M,...s,...r},x={context:e,...M,...H({bps:M.breakpoints,bridge:M.bridge,context:e}),styles:{},version:Ce},x},g=()=>x,ye=(e,s)=>{x.styles[e]=s},ke=e=>(x={...x,...e},e.breakpoints&&(x={...x,...H({bps:x.breakpoints,bridge:x.bridge,scope:x.scope,context:x.context})}),x),S=e=>{let s,r=e,t=!1;const n=r.includes("@");if(n){const i=r.split("@");r=i[0],s=i[1]}else{const i=g();s=Object.keys(i.breakpoints)[0]}return e.includes("!")&&(t=!0,s=s.replace(/!/g,""),r=r.replace(/!/g,"")),{widthBp:n,numbers:r,breakPoints:s,important:t}},C=(e,s,r)=>{const t=new Error;return t.name=e,t.message=s,g().debug&&(console.error(t),r&&console.log(r)),t},W=(e,s)=>{const r=e*100/s;return(r-Math.floor(r)!==0?r.toFixed(3):r)+"%"},ve=e=>{const s=e.replace(/!/g,""),r=s.indexOf("@"),t=g(),n=t.scope,i=t.bridge,o=t.context;if(r===-1){const f=Object.keys(t.breakpoints)[0];return n[f]}const l=s.substring(r+1);if(!l.includes("-"))return n[l];if(l.substring(0,1)==="-"){if(n[l])return n[l];const f=l.substring(1);return n[l]=A({bridge:i,bp:l,insertionType:"before",node:n[f].node,context:o}),n[l]}if(n[l])return n[l];const a=l.split("-")[0];return n[l]=A({bridge:i,bp:l,insertionType:"after",node:n[a].node,context:o}),n[l]},z=e=>{const s=g();for(const r in e)if(!s.styles[r]){const t=ve(r),n=e[r],i=t.method.rules;t.method.insertRule(n,i?i.length:0),ye(r,n)}},p={jc:{ruleCss:"justify-content",classPrefix:"jc"},ai:{ruleCss:"align-items",classPrefix:"ai"},ce:{ruleCss:"center",classPrefix:"ce"},fs:{ruleCss:"flex-start",classPrefix:"fs"},fe:{ruleCss:"flex-end",classPrefix:"fe"},sb:{ruleCss:"space-between",classPrefix:"sb"},sa:{ruleCss:"space-around",classPrefix:"sa"},fw:{ruleCss:"flex-wrap",classPrefix:"fw"},nw:{ruleCss:"nowrap",classPrefix:"nw"},w:{ruleCss:"wrap",classPrefix:"w"},wr:{ruleCss:"wrap-reverse",classPrefix:"wr"},fd:{ruleCss:"flex-direction",classPrefix:"fd"},r:{ruleCss:"row",classPrefix:"r"},rr:{ruleCss:"row-reverse",classPrefix:"rr"},co:{ruleCss:"column",classPrefix:"co"},cor:{ruleCss:"column-reverse",classPrefix:"co"},au:{ruleCss:"auto",classPrefix:"au"},st:{ruleCss:"stretch",classPrefix:"st"},bl:{ruleCss:"baseline",classPrefix:"bl"},in:{ruleCss:"initial",classPrefix:"in"},ih:{ruleCss:"inherit",classPrefix:"ih"}},T={fg:{ruleCss:"flex-grow",classPrefix:"fg"},fh:{ruleCss:"flex-shrink",classPrefix:"fh"},as:{ruleCss:"align-self",classPrefix:"as"},or:{ruleCss:"order",classPrefix:"or"}},I={...T,"flex-grow":T.fg,"flex-shrink":T.fh,"align-self":T.as,order:T.or},O={...p,...I,"justify-content":p.jc,"align-items":p.ai,center:p.ce,"flex-start":p.fs,"flex-end":p.fe,"space-between":p.sb,"space-around":p.fs,"flex-wrap":p.fw,nowrap:p.nw,w:p.w,"wrap-reverse":p.wr,"flex-direction":p.fd,row:p.r,"row-reverse":p.rr,column:p.co,"column-reverse":p.cor,auto:p.au,stretch:p.st,baseline:p.bl,initial:p.in,inherit:p.ih},U=Object.keys(I),je=e=>"0\xAF"+e.replace("%",""),Ae=(e,s)=>{const r=g(),t=r.sizes,n=r.prefix,i=j[e].ruleCss,o={};return Object.keys(s).forEach(l=>{const a=s[l].name;let f=a;if(a.includes("%")&&(f=a.replace(a,je(a))),f=(n?n+"-":"")+j[e].classPrefix+"-"+f.replace(/\//g,"\\/").replace(/:/g,"\\:").replace("@","\\@").split(".").join("_"),r.styles[f])o[f]=r.styles[f];else{let h;if(e==="flex"){h=s[l].value;const k=a.includes("!")?";display:flex !important;":";display:flex;",P=U.filter(B=>a.includes(B+":"));P.length?P.length+1!==a.split(":").length&&(h+=k):h+=k}else h=i+":"+s[l].value;let u="@media screen and ",y=!1;if(!l.includes("-"))t[l]?u+="(min-width: "+t[l]+"px)":(u="."+f.replace(/!/g,"\\!")+"{"+h+"}",y=!0);else{const k=l.split("-"),P=k[0];P&&(u+="(min-width: "+t[P]+"px) and ");const B=k[1];u+="(max-width: "+(t[B]-1)+"px)"}y||(u+="{."+f.replace(/!/g,"\\!")+"{"+h+"}}"),o[f]=u}}),o},Oe=[["/",""],["\\","/"],["/:",":"],["\\:",":"],["\\@","@"],["/@","@"]],Be=e=>{const s={};for(const r in e){let t=r;Oe.forEach(n=>{t=t.split(n[0]).join(n[1])}),s[t]=e[r]}return s},L=e=>{const s=Ae(e.type,e.bps);return e.deep&&z(s),Be(s)},D=(e,s=!1)=>{let r,t;const n={},i=g();let o,l,a;const f=Object.keys(i.breakpoints)[0];let d=!1;for(const h of e.split(" ")){let u=h;if(o=u,a=S(u),t=a.breakPoints,u=a.numbers,u.includes("/")){const y=u.split("/");r=[Number(y[0]),Number(y[1])]}else if(a.widthBp)if(t.includes("-")){d=C("SyntaxError","You can't determine a 'until breakpoint' when use the explicit columns max: "+e);break}else r=[Number(u),i.cols[t]];else r=[Number(u),i.cols[f]];l=W(r[0],r[1]),a.important&&(l+=" !important"),n[t]={name:o,value:l}}return d||L({type:"cols",bps:n,deep:s})},N=(e,s=!1)=>{const r={};let t=!1;const n=g(),i=Object.keys(n.breakpoints)[0];for(const o of e.split(" ")){let l;const a=S(o),f=a.breakPoints,d=a.numbers.split(":"),h=d[0],u=d[1];let y;if(U.includes(h))l=O[h].ruleCss+":"+u,y=u;else{if(!O[h]){t=C("Non-existent Alias","Don't exists the alias '"+h+"' in Flex vault.");break}if(!O[u]){t=C("Non-existent Alias","Don't exists the alias '"+u+"' in Flex vault.");break}l=O[h].ruleCss+":"+O[u].ruleCss,y=O[u].classPrefix}let k=f===i?"":"@"+f;a.important&&(l+=" !important",k+="!");let P=O[h].classPrefix+":"+y+k;if(!r[f])r[f]={name:P,value:l};else{P.includes("@")&&(P=P.split("@")[0]);let B=r[f].name.split("@")[0];r[f].name.includes("!")&&!B.includes("!")&&(B+="!"),r[f].name=B+"-"+P+k,r[f].value+=";"+l}}return t||L({type:"flex",bps:r,deep:s})},Ee=["%","rem","em","ex","vw","vh","pt","cm","pc"],Me=e=>{let s;return e.includes("/")?(s=e.split("/"),s=W(parseFloat(s[0]),parseFloat(s[1]))):e==="auto"?s="auto":Ee.filter(t=>e.includes(t)).length?s=e:s=e==="0"?e:e+"px",s},m=(e,s,r=!1)=>{const t={};return e.split(" ").forEach(n=>{const i=S(n),o=i.breakPoints;let l=i.numbers.split("-").map(a=>Me(a)).join(" ");i.important&&(l+=" !important"),t[o]={name:n,value:l}}),L({type:s,bps:t,deep:r})},q=(e,s=!1)=>m(e,"pad",s),Y=(e,s=!1)=>m(e,"padt",s),_=(e,s=!1)=>m(e,"padr",s),$=(e,s=!1)=>m(e,"padb",s),G=(e,s=!1)=>m(e,"padl",s),J=(e,s=!1)=>m(e,"mar",s),K=(e,s=!1)=>m(e,"mart",s),Q=(e,s=!1)=>m(e,"marr",s),X=(e,s=!1)=>m(e,"marb",s),Z=(e,s=!1)=>m(e,"marl",s),ee=(e,s=!1)=>m(e,"mxw",s),se=(e,s=!1)=>m(e,"mxh",s),te=(e,s=!1)=>m(e,"miw",s),re=(e,s=!1)=>m(e,"mih",s),ne=(e,s=!1)=>m(e,"hgt",s),ie=(e,s=!1)=>m(e,"wdh",s),v={st:{ruleCss:"static",classPrefix:"st"},ab:{ruleCss:"absolute",classPrefix:"ab"},fi:{ruleCss:"fixed",classPrefix:"fi"},re:{ruleCss:"relative",classPrefix:"re"},si:{ruleCss:"sticky",classPrefix:"si"},in:{ruleCss:"initial",classPrefix:"in"},ih:{ruleCss:"inherit",classPrefix:"ih"}},F={...v,static:v.st,absolute:v.ab,fixed:v.fi,relative:v.re,sticky:v.si,initial:v.in,inherit:v.ih},le=(e,s=!1)=>{const r={};let t=!1;const n=g(),i=Object.keys(n.breakpoints)[0];for(const o of e.split(" ")){let l;const a=S(o),f=a.breakPoints,d=a.numbers;if(!F[d]){t=C("Non-existent Alias","Don't exists the alias '"+d+"' in Position vault.");break}l=F[d].ruleCss;const h=F[d].classPrefix;let u=f===i?"":"@"+f;a.important&&(l+=" !important",u+="!"),r[f]={name:h+u,value:l}}return t||L({type:"pos",bps:r,deep:s})},ae=(e,s=!1)=>m(e,"t",s),oe=(e,s=!1)=>m(e,"r",s),ce=(e,s=!1)=>m(e,"b",s),fe=(e,s=!1)=>m(e,"l",s),w={bl:{ruleCss:"block",classPrefix:"bl"},il:{ruleCss:"inline",classPrefix:"il"},ib:{ruleCss:"inline-block",classPrefix:"ib"},fx:{ruleCss:"flex",classPrefix:"fx"},if:{ruleCss:"inline-flex",classPrefix:"if"},no:{ruleCss:"none",classPrefix:"no"},in:{ruleCss:"initial",classPrefix:"in"},ih:{ruleCss:"inherit",classPrefix:"ih"}},R={...w,block:w.bl,inline:w.il,"inline-block":w.ib,flex:w.fx,"inline-flex":w.if,none:w.no,initial:w.in,inherit:w.ih},c={cols:{build:D,ruleCss:"width",classPrefix:"c"},pad:{build:q,ruleCss:"padding",classPrefix:"p"},padt:{build:Y,ruleCss:"padding-top",classPrefix:"pt"},padr:{build:_,ruleCss:"padding-right",classPrefix:"pr"},padb:{build:$,ruleCss:"padding-bottom",classPrefix:"pb"},padl:{build:G,ruleCss:"padding-left",classPrefix:"pl"},mar:{build:J,ruleCss:"margin",classPrefix:"m"},mart:{build:K,ruleCss:"margin-top",classPrefix:"mt"},marr:{build:Q,ruleCss:"margin-right",classPrefix:"mr"},marb:{build:X,ruleCss:"margin-bottom",classPrefix:"mb"},marl:{build:Z,ruleCss:"margin-left",classPrefix:"ml"},flex:{build:N,ruleCss:"display: flex",classPrefix:"fx"},mxw:{build:ee,ruleCss:"max-width",classPrefix:"mxw"},mxh:{build:se,ruleCss:"max-height",classPrefix:"mxh"},miw:{build:te,ruleCss:"min-width",classPrefix:"miw"},mih:{build:re,ruleCss:"min-height",classPrefix:"mih"},wdh:{build:ie,ruleCss:"width",classPrefix:"w"},hgt:{build:ne,ruleCss:"height",classPrefix:"h"},pos:{build:le,ruleCss:"position",classPrefix:"pos"},t:{build:ae,ruleCss:"top",classPrefix:"t"},r:{build:oe,ruleCss:"right",classPrefix:"r"},b:{build:ce,ruleCss:"bottom",classPrefix:"b"},l:{build:fe,ruleCss:"left",classPrefix:"l"},d:{build:(e,s=!1)=>{const r={};let t=!1;const n=g(),i=Object.keys(n.breakpoints)[0];for(const o of e.split(" ")){let l;const a=S(o),f=a.breakPoints,d=a.numbers;if(!R[d]){t=C("Non-existent Alias","Don't exists the alias '"+d+"' in display vault.");break}l=R[d].ruleCss;const h=R[d].classPrefix;let u=f===i?"":"@"+f;a.important&&(l+=" !important",u+="!"),r[f]={name:h+u,value:l}}return t||L({type:"d",bps:r,deep:s})},ruleCss:"display",classPrefix:"d"}},j={...c,c:c.cols,fx:c.flex,p:c.pad,padding:c.pad,pt:c.padt,"padding-top":c.padt,pr:c.padr,"padding-right":c.padr,pb:c.padb,"padding-bottom":c.padb,pl:c.padl,"padding-left":c.padl,m:c.mar,margin:c.mar,mt:c.mart,"margin-top":c.mart,mr:c.marr,"margin-right":c.marr,mb:c.marb,"margin-bottom":c.marb,ml:c.marl,"margin-left":c.marl,w:c.wdh,width:c.wdh,h:c.hgt,height:c.hgt,"max-width":c.mxw,"max-height":c.mxh,"min-width":c.miw,"min-height":c.mih,position:c.pos,top:c.t,right:c.r,bottom:c.b,left:c.l,display:c.d},ue=e=>{const s={},r=e.attributes,t=Object.keys(j);return Array.prototype.forEach.call(r,n=>{t.includes(n.name)&&n.value!==""&&(s[n.name]=n.value.trim().split(" ").filter(i=>i).join(" "))}),s},de=(e,s=!1)=>{const r={};let t=!1;for(const n in e){const o=j[n].build(e[n],s);if(o instanceof Error){t=o;break}else r[n]=o}return t||r},pe=(e,s,r)=>new Promise(t=>{const n=g(),i=s.split(" ");let o=i;if(!r&&(o=i.filter(a=>!e.classList.contains(a)),!o.length)){t();return}const l=new n.context.MutationObserver(a=>{const d=a[0].target.className.split(" ");i.every(u=>d.includes(u))&&(l.disconnect(),t())});if(l.observe(e,{childList:!1,subtree:!1,attributes:!0,attributeFilter:["class"],characterData:!1}),r)e.className=s;else{const a=e.hasAttribute("class")?" ":"";e.className+=a+o.join(" ")}}),me=(e,s,r)=>new Promise(t=>{if(!e.hasAttribute(s)){t();return}const n=new r.MutationObserver(()=>{n.disconnect(),t()});n.observe(e,{childList:!1,subtree:!1,attributes:!0,attributeFilter:[s],characterData:!1}),e.removeAttribute(s)}),Se=(e,s,r)=>new Promise(t=>{const n=s.map(i=>me(e,i,r));Promise.all(n).then(()=>t())}),be=(e,s)=>new Promise(r=>{const t=g();Array.isArray(s)?Se(e,s,t.context).then(r):me(e,s,t.context).then(r)}),V=({node:e,directive:s,classes:r,resolve:t})=>{const n=g();be(e,s).then(()=>pe(e,r)).then(()=>{t();const i=new n.context.CustomEvent("layout:ready");e.dispatchEvent(i)})},Te=(e,s)=>new Promise((r,t)=>{const n=s||ue(e),i=Object.keys(n);if(!i.length){const d=C("Parameter Missing","don't exists any parameter to process",e);t(d);return}const o={};for(const d in n)o[d]=n[d];const l=de(o,!0);if(l instanceof Error){t(l);return}const a=l,f=Object.keys(a).map(d=>Object.keys(a[d])).flat().join(" ");V({node:e,directive:i,classes:f,resolve:r})}),Le=(e,s)=>new Promise((r,t)=>{const n=s||e.getAttribute("flex");if(!n){const l=C("Empty",'The value of the directive "flex" is empty',e);t(l);return}const i=N(n,!0);if(i instanceof Error){t(i);return}const o=Object.keys(i).join(" ");V({node:e,directive:"flex",classes:o,resolve:r})}),Ve=(e,s)=>new Promise((r,t)=>{const n=s||e.getAttribute("cols");if(!n){const l=C("Empty","The value of the directive 'cols' is empty",e);t(l);return}const i=D(n,!0);if(i instanceof Error){t(i);return}const o=Object.keys(i).join(" ");V({node:e,directive:"cols",classes:o,resolve:r})}),b=(e,s,r)=>new Promise((t,n)=>{const i=r||e.getAttribute(s);if(!i){const a=C("Empty",'The value of the directive "'+s+'" is empty',e);n(a);return}const o=m(i,s,!0),l=Object.keys(o).join(" ");V({node:e,directive:s,classes:l,resolve:t})}),De=(e,s)=>b(e,"hgt",s),Ne=(e,s)=>b(e,"marb",s),Fe=(e,s)=>b(e,"marl",s),Re=(e,s)=>b(e,"marr",s),He=(e,s)=>b(e,"mar",s),We=(e,s)=>b(e,"mart",s),ze=(e,s)=>b(e,"mxw",s),Ie=(e,s)=>b(e,"mih",s),Ue=(e,s)=>b(e,"miw",s),qe=(e,s)=>b(e,"padb",s),Ye=(e,s)=>b(e,"padl",s),_e=(e,s)=>b(e,"padr",s),$e=(e,s)=>b(e,"pad",s),Ge=(e,s)=>b(e,"padt",s),Je=(e,s)=>b(e,"wdh",s),Ke=(e,s)=>b(e,"mxh",s),Qe=(e,s)=>b(e,"pos",s),Xe=(e,s)=>b(e,"t",s),Ze=(e,s)=>b(e,"r",s),es=(e,s)=>b(e,"b",s),ss=(e,s)=>b(e,"l",s),ts=e=>new Promise(s=>{const t=[...new Set(Object.keys(j).map(i=>j[i].classPrefix))],n=e.className.split(" ").filter(i=>i.includes("-")?!t.find(l=>{const a=l.length;return i.substring(0,a+1)===l+"-"}):!0);if(n.length){const i=n.join(" ");pe(e,i,!0).then(()=>{s()})}else be(e,"class").then(()=>{s()})}),he=(e,s)=>new Promise(r=>{const n=Object.keys(j).map(a=>`[${a}]`).join(", "),i=s.querySelectorAll(n);if(!i.length){r(e);return}const o=new Set;Array.prototype.forEach.call(i,a=>{o.add(a)});const l=[];o.forEach(a=>{l.push(e.set(a))}),Promise.all(l).then(r)}),rs=e=>{const s=g(),r=Object.keys(j),t=new e.context.MutationObserver(i=>{for(const o of i)if(o.type==="childList"){if(!o.addedNodes.length)continue;o.addedNodes.forEach(l=>{if(l instanceof HTMLElement){const a=e.getParameters(l);Object.keys(a).length&&e.set(l,a),he(e,l)}})}else if(o.type==="attributes"){const l=o.target;if(l instanceof HTMLElement){const a=e.getParameters(l);Object.keys(a).length&&e.set(l,a)}}}),n={childList:!0,subtree:!0,attributes:!0,attributeFilter:r,characterData:!1};t.observe(s.context.document.body,n)},xe=(e,s={})=>{const t={...we(e,s),getParameters:ue,updateConfig:ke,insertRules:z,build:de,buildCols:D,buildFlex:N,buildPad:q,buildPadTop:Y,buildPadRight:_,buildPadBottom:$,buildPadLeft:G,buildMar:J,buildMarTop:K,buildMarRight:Q,buildMarBottom:X,buildMarLeft:Z,buildMaxWidth:ee,buildMaxHeight:se,buildMinWidth:te,buildMinHeight:re,buildHeight:ne,buildWidth:ie,set:Te,setCols:Ve,setFlex:Le,setMar:He,setMarTop:We,setMarRight:Re,setMarBottom:Ne,setMarLeft:Fe,setPad:$e,setPadTop:Ge,setPadRight:_e,setPadBottom:qe,setPadLeft:Ye,setWidth:Je,setMinWidth:Ue,setMaxWidth:ze,setHeight:De,setMinHeight:Ie,setMaxHeight:Ke,reset:ts,buildPosition:le,buildTop:ae,buildRight:oe,buildBottom:ce,buildLeft:fe,setPosition:Qe,setTop:Xe,setRight:Ze,setBottom:es,setLeft:ss};return he(t,e.document).then(()=>{t.ready&&t.ready(t),rs(t)}),t};return typeof window!="undefined"&&typeof exports=="undefined"&&(window.layouter=xe(window)),xe});
//# sourceMappingURL=layouter.umd.js.map

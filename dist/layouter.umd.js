(function(C,g){typeof exports=="object"&&typeof module!="undefined"?module.exports=g():typeof define=="function"&&define.amd?define(g):(C=typeof globalThis!="undefined"?globalThis:C||self,C.Layouter=g())})(this,function(){"use strict";const C=(e,t)=>{const n={};return t==="width"?Object.keys(e).map(s=>({alias:s,width:e[s].width})).sort((s,r)=>s.width>r.width?1:r.width>s.width?-1:0).forEach((s,r)=>{n[s.alias]=r?e[s.alias][t]:0}):Object.keys(e).forEach(s=>{n[s]=e[s][t]}),n},g=({bridge:e,bp:t,insertionType:n,node:s})=>{let r=document.getElementById("layouter-"+t);if(!r){r=document.createElement("style"),r.appendChild(document.createTextNode(""));const i=s.parentNode;switch(n){case"before":i.insertBefore(r,s);break;case"after":s.nextSibling?i.insertBefore(r,s.nextSibling):i.appendChild(r);break;case"append":s.appendChild(r);break}r.id="layouter-"+t}let o;return e?o={method:r.sheet,node:r}:o={method:{insertRule:i=>{r.appendChild(document.createTextNode(i))},rules:[]},node:r},o},ne=(e,t,n)=>{const s=n||{};return Object.keys(e).forEach(r=>{s[r]||(s[r]=g({bridge:t,bp:r,insertionType:"append",node:document.body}))}),s},ie=(e,t)=>{const n={};return Object.keys(t).forEach(s=>n[s]=e[s]),n},oe="1.2.0";let x={prefix:"",breakpoints:{xs:{width:360,cols:15},sm:{width:600,cols:25},md:{width:900,cols:31},lg:{width:1200,cols:41},xlg:{width:1536,cols:51}},bridge:!0,debug:!0},m;const L=(e,t,n)=>{const s=C(e,"width"),r=ie(e,s);return{sizes:s,cols:C(e,"cols"),scope:ne(r,t,n),breakpoints:r}},F=(e={})=>(window&&window.layouterConfig?x={...x,...window.layouterConfig,...e}:e&&(x={...x,...e}),m={...x,...L(x.breakpoints,x.bridge),styles:{},version:oe},m),le=(e,t)=>{m.styles[e]=t},y=(e=!1)=>e?F():m,ae=e=>(m={...m,...e},e.breakpoints&&(m={...m,...L(m.breakpoints,m.bridge,m.scope)}),m),k={cols:{set:"setCols",build:"buildCols",ruleCss:"width"},pad:{set:"setPad",build:"buildPad",ruleCss:"padding"},padt:{set:"setPadTop",build:"buildPadTop",ruleCss:"padding-top"},padr:{set:"setPadRight",build:"buildPadRight",ruleCss:"padding-right"},padb:{set:"setPadBottom",build:"buildPadBottom",ruleCss:"padding-bottom"},padl:{set:"setPadLeft",build:"buildPadLeft",ruleCss:"padding-left"},mar:{set:"setMar",build:"buildMar",ruleCss:"margin"},mart:{set:"setMarTop",build:"buildMarTop",ruleCss:"margin-top"},marr:{set:"setMarRight",build:"buildMarRight",ruleCss:"margin-right"},marb:{set:"setMarBottom",build:"buildMarBottom",ruleCss:"margin-bottom"},marl:{set:"setMarLeft",build:"buildMarLeft",ruleCss:"margin-left"},flex:{set:"setFlex",build:"buildFlex",ruleCss:"display: flex"},mxw:{set:"setMaxWidth",build:"buildMaxWidth",ruleCss:"max-width"},mxh:{set:"setMaxHeight",build:"buildMaxHeight",ruleCss:"max-height"},miw:{set:"setMinWidth",build:"buildMinWidth",ruleCss:"min-width"},mih:{set:"setMinHeight",build:"buildMinHeight",ruleCss:"min-height"},wdh:{set:"setWidth",build:"buildWidth",ruleCss:"width"},hgt:{set:"setHeight",build:"buildHeight",ruleCss:"height"}},H=e=>{const t={},n=e.attributes,s=Object.keys(k);return Array.prototype.forEach.call(n,r=>{s.includes(r.name)&&r.value!==""&&(t[r.name]=r.value.trim().split(" ").filter(o=>o).join(" "))}),t},A=e=>{let t,n=e,s=!1;const r=n.includes("@");if(r){const o=n.split("@");n=o[0],t=o[1]}else{const o=y();t=Object.keys(o.breakpoints)[0]}return e.includes("!")&&(s=!0,t=t.replace(/!/g,""),n=n.replace(/!/g,"")),{widthBp:r,numbers:n,breakPoints:t,important:s}},w=(e,t,n)=>{const s=new Error;return s.name=e,s.message=t,y().debug&&(console.error(s),n&&console.log(n)),s},W=(e,t)=>{const n=e*100/t;return(n-Math.floor(n)!==0?n.toFixed(3):n)+"%"},ce=e=>{const t=e.replace(/!/g,""),n=t.indexOf("@"),s=y(),r=s.scope,o=s.bridge;if(n===-1){const a=Object.keys(s.breakpoints)[0];return r[a]}const i=t.substring(n+1);if(!i.includes("-"))return r[i];if(i.substring(0,1)==="-"){if(r[i])return r[i];const a=i.substring(1);return r[i]=g({bridge:o,bp:i,insertionType:"before",node:r[a].node}),r[i]}if(r[i])return r[i];const l=i.split("-")[0];return r[i]=g({bridge:o,bp:i,insertionType:"after",node:r[l].node}),r[i]},R=e=>{const t=y();for(const n in e)if(!t.styles[n]){const s=ce(n),r=e[n],o=s.method.rules;s.method.insertRule(r,o?o.length:0),le(n,r)}},M={jc:"justify-content",ai:"align-items",ce:"center",fs:"flex-start",fe:"flex-end",sb:"space-between",sa:"space-around",fw:"flex-wrap",nw:"nowrap",w:"wrap",wr:"wrap-reverse",fd:"flex-direction",r:"row",rr:"row-reverse",co:"column",cor:"column-reverse",fg:"flex-grow",fh:"flex-shrink",as:"align-self",or:"order",au:"auto",st:"stretch",bl:"baseline",in:"initial",ih:"inherit"},D=["fg","fh","or"],ue=e=>"0\xAF"+e.replace("%",""),de=(e,t)=>{const n=y(),s=n.sizes,r=n.prefix,o=k[e].ruleCss,i={};return Object.keys(t).forEach(l=>{const a=t[l].name;let p=a;a.includes("%")&&(p=a.replace(a,ue(a))),p=(r?r+"-":"")+e+"-"+p.replace(/\//g,"\\/").replace(/:/g,"\\:").replace("@","\\@").split(".").join("_");let b;if(e==="flex"){b=t[l].value;const P=a.includes("!")?";display:flex !important;":";display:flex;",O=["as"].concat(D).filter(B=>a.includes(B+":"));O.length?O.length+1!==a.split(":").length&&(b+=P):b+=P}else b=o+":"+t[l].value;let u="@media screen and ",h=!1;if(!l.includes("-"))s[l]?u+="(min-width: "+s[l]+"px)":(u="."+p.replace(/!/g,"\\!")+"{"+b+"}",h=!0);else{const P=l.split("-"),O=P[0];O&&(u+="(min-width: "+s[O]+"px) and ");const B=P[1];u+="(max-width: "+(s[B]-1)+"px)"}h||(u+="{."+p.replace(/!/g,"\\!")+"{"+b+"}}"),i[p]=u}),i},fe=[["/",""],["\\","/"],["/:",":"],["\\:",":"],["\\@","@"],["/@","@"]],pe=e=>{const t={};for(const n in e){let s=n;fe.forEach(r=>{s=s.split(r[0]).join(r[1])}),t[s]=e[n]}return t},E=e=>{const t=de(e.type,e.bps);return e.deep&&R(t),pe(t)},T=(e,t=!1)=>{let n,s;const r={},o=y();let i,l,a;const p=Object.keys(o.breakpoints)[0];let c=!1;for(const b of e.split(" ")){let u=b;if(i=u,a=A(u),s=a.breakPoints,u=a.numbers,u.includes("/")){const h=u.split("/");n=[Number(h[0]),Number(h[1])]}else if(a.widthBp)if(s.includes("-")){c=w("SyntaxError","You can't determine a 'until breakpoint' when use the explicit columns max: "+e);break}else n=[Number(u),o.cols[s]];else n=[Number(u),o.cols[p]];l=W(n[0],n[1]),a.important&&(l+=" !important"),r[s]={name:i,value:l}}return c||E({type:"cols",bps:r,deep:t})},S=(e,t=!1)=>{const n={};let s=!1;const r=y(),o=Object.keys(r.breakpoints)[0];for(const i of e.split(" ")){let l,a=i;const p=A(i),c=p.breakPoints,b=p.numbers.split(":"),u=b[0],h=b[1];if(D.includes(u))l=M[u]+":"+h;else{if(!M[u]){s=w("Non-existent Alias","Don't exists the alias '"+u+"' in Flex vault.");break}if(!M[h]){s=w("Non-existent Alias","Don't exists the alias '"+h+"' in Flex vault.");break}l=M[u]+":"+M[h]}if(p.important&&(l+=" !important"),!n[c])n[c]={name:a,value:l};else{a.includes("@")&&(a=a.split("@")[0]);const P=c===o?"":"@"+c;n[c].name=n[c].name.split("@")[0]+"-"+a+P,n[c].value+=";"+l}}return s||E({type:"flex",bps:n,deep:t})},be=["%","rem","em","ex","vw","vh"],me=e=>{let t;return e.includes("/")?(t=e.split("/"),t=W(parseFloat(t[0]),parseFloat(t[1]))):e==="auto"?t="auto":be.filter(s=>e.includes(s)).length?t=e:t=e==="0"?e:e+"px",t},d=(e,t,n=!1)=>{const s={};return e.split(" ").forEach(r=>{const o=A(r),i=o.breakPoints;let l=o.numbers.split("-").map(a=>me(a)).join(" ");o.important&&(l+=" !important"),s[i]={name:r,value:l}}),E({type:t,bps:s,deep:n})},V=(e,t=!1)=>d(e,"pad",t),I=(e,t=!1)=>d(e,"padt",t),z=(e,t=!1)=>d(e,"padr",t),U=(e,t=!1)=>d(e,"padb",t),N=(e,t=!1)=>d(e,"padl",t),q=(e,t=!1)=>d(e,"mar",t),Y=(e,t=!1)=>d(e,"mart",t),_=(e,t=!1)=>d(e,"marr",t),$=(e,t=!1)=>d(e,"marb",t),G=(e,t=!1)=>d(e,"marl",t),J=(e,t=!1)=>d(e,"mxw",t),K=(e,t=!1)=>d(e,"mxh",t),Q=(e,t=!1)=>d(e,"miw",t),X=(e,t=!1)=>d(e,"mih",t),Z=(e,t=!1)=>d(e,"hgt",t),ee=(e,t=!1)=>d(e,"wdh",t),he={buildCols:T,buildFlex:S,buildPad:V,buildPadTop:I,buildPadRight:z,buildPadBottom:U,buildPadLeft:N,buildMar:q,buildMarTop:Y,buildMarRight:_,buildMarBottom:$,buildMarLeft:G,buildMaxWidth:J,buildMaxHeight:K,buildMinWidth:Q,buildMinHeight:X,buildHeight:Z,buildWidth:ee},te=(e,t=!1)=>{const n={};let s=!1;for(const r in e){const o=k[r],i=he[o.build](e[r],t);if(i instanceof Error){s=i;break}else n[r]=i}return s||n},v=(e,t,n)=>new Promise(s=>{const r=t.split(" ");let o=r;if(!n&&(o=r.filter(l=>!e.classList.contains(l)),!o.length)){s();return}const i=new MutationObserver(l=>{const p=l[0].target.className.split(" ");r.every(b=>p.includes(b))&&(i.disconnect(),s())});if(i.observe(e,{childList:!1,subtree:!1,attributes:!0,attributeFilter:["class"],characterData:!1}),n)e.className=t;else{const l=e.hasAttribute("class")?" ":"";e.className+=l+o.join(" ")}}),se=(e,t)=>new Promise(n=>{if(!e.hasAttribute(t)){n();return}const s=new MutationObserver(()=>{s.disconnect(),n()});s.observe(e,{childList:!1,subtree:!1,attributes:!0,attributeFilter:[t],characterData:!1}),e.removeAttribute(t)}),ge=(e,t)=>new Promise(n=>{const s=t.map(r=>se(e,r));Promise.all(s).then(()=>n())}),j=(e,t)=>new Promise(n=>{Array.isArray(t)?ge(e,t).then(n):se(e,t).then(n)}),xe=(e,t)=>new Promise((n,s)=>{const r=t||H(e),o=Object.keys(r);if(!o.length){const c=w("Parameter Missing","don't exists any parameter to process",e);s(c);return}const i={};for(const c in r)i[c]=r[c];const l=te(i,!0);if(l instanceof Error){s(l);return}const a=l,p=Object.keys(a).map(c=>Object.keys(a[c])).flat().join(" ");j(e,o).then(()=>v(e,p)).then(n)}),ye=(e,t)=>new Promise((n,s)=>{const r=t||e.getAttribute("flex");if(!r){const l=w("Empty",'The value of the directive "flex" is empty',e);s(l);return}const o=S(r,!0);if(o instanceof Error){s(o);return}const i=Object.keys(o).join(" ");j(e,"flex").then(()=>v(e,i)).then(n)}),we=(e,t)=>new Promise((n,s)=>{const r=t||e.getAttribute("cols");if(!r){const l=w("Empty","The value of the directive 'cols' is empty",e);s(l);return}const o=T(r,!0);if(o instanceof Error){s(o);return}const i=Object.keys(o).join(" ");j(e,"cols").then(()=>v(e,i)).then(n)}),f=(e,t,n)=>new Promise((s,r)=>{const o=n||e.getAttribute(t);if(!o){const a=w("Empty",'The value of the directive "'+t+'" is empty',e);r(a);return}const i=d(o,t,!0),l=Object.keys(i).join(" ");j(e,t).then(()=>v(e,l)).then(s)}),Pe=(e,t)=>f(e,"hgt",t),Ce=(e,t)=>f(e,"marb",t),ke=(e,t)=>f(e,"marl",t),Me=(e,t)=>f(e,"marr",t),ve=(e,t)=>f(e,"mar",t),je=(e,t)=>f(e,"mart",t),Oe=(e,t)=>f(e,"mxw",t),Ae=(e,t)=>f(e,"mih",t),Ee=(e,t)=>f(e,"miw",t),Te=(e,t)=>f(e,"padb",t),Se=(e,t)=>f(e,"padl",t),Be=(e,t)=>f(e,"padr",t),Le=(e,t)=>f(e,"pad",t),Fe=(e,t)=>f(e,"padt",t),He=(e,t)=>f(e,"wdh",t),We=(e,t)=>f(e,"mxh",t),Re=e=>new Promise(t=>{const n=Object.keys(k),s=[];if(e.className.split(" ").filter(r=>{if(r.length<4)return s.push(r),!1;const o=r.length>=5?5:4;let i=r.substring(0,o);const l=i.split("").indexOf("-");return l===-1?(s.push(r),!1):(i=i.substring(0,l),n.includes(i)?!0:(s.push(r),!1))}),s.length){const r=s.join(" ");v(e,r,!0).then(()=>{t()})}else j(e,"class").then(()=>{t()})}),De=e=>new Promise(t=>{const s=Object.keys(k).map(l=>`[${l}]`).join(", "),r=document.querySelectorAll(s),o=new Set;Array.prototype.forEach.call(r,l=>{o.add(l)});const i=[];o.forEach(l=>{i.push(e.set(l))}),Promise.all(i).then(t)}),Ve=e=>{const t=Object.keys(k),n=new MutationObserver(r=>{for(const o of r)if(o.type==="childList"){if(!o.addedNodes.length)continue;o.addedNodes.forEach(i=>{if(i instanceof HTMLElement){const l=e.getParameters(i);Object.keys(l).length&&e.set(i,l)}})}else if(o.type==="attributes"){const i=o.target;if(i instanceof HTMLElement){const l=e.getParameters(i);Object.keys(l).length&&e.set(i,l)}}}),s={childList:!0,subtree:!0,attributes:!0,attributeFilter:t,characterData:!1};n.observe(document.body,s)},re=(e={})=>{const n={...F(e),getParameters:H,updateConfig:ae,insertRules:R,build:te,buildCols:T,buildFlex:S,buildPad:V,buildPadTop:I,buildPadRight:z,buildPadBottom:U,buildPadLeft:N,buildMar:q,buildMarTop:Y,buildMarRight:_,buildMarBottom:$,buildMarLeft:G,buildMaxWidth:J,buildMaxHeight:K,buildMinWidth:Q,buildMinHeight:X,buildHeight:Z,buildWidth:ee,set:xe,setCols:we,setFlex:ye,setMar:ve,setMarTop:je,setMarRight:Me,setMarBottom:Ce,setMarLeft:ke,setPad:Le,setPadTop:Fe,setPadRight:Be,setPadBottom:Te,setPadLeft:Se,setWidth:He,setMinWidth:Ee,setMaxWidth:Oe,setHeight:Pe,setMinHeight:Ae,setMaxHeight:We,reset:Re};return De(n).then(()=>{n.ready&&n.ready(n),Ve(n)}),n};return window&&typeof exports=="undefined"&&(window.layouter=re()),re});
//# sourceMappingURL=layouter.umd.js.map
